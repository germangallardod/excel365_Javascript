{"version":"0.3.0","body":"function main(workbook: ExcelScript.Workbook) {\n  let sheet = workbook.getActiveWorksheet();\n  let range = sheet.getRange(\"B7:K49\"); // Adjusted range\n  let password = \"Panque\";\n\n  // Unprotect the sheet with the password\n  sheet.getProtection().unprotect(password);\n\n  // Read all values at once\n  let values = range.getValues();\n\n  // Prepare arrays to hold the changes\n  let lockCells: ExcelScript.Range[] = [];\n  let unlockCells: ExcelScript.Range[] = [];\n\n  // Process each cell individually\n  values.forEach((row, rowIndex) => {\n    row.forEach((cell, colIndex) => {\n      let cellRange = sheet.getRangeByIndexes(rowIndex + 6, colIndex + 1, 1, 1); // Adjusting for B7 start\n      let cellProtectionStatus = cellRange.getFormat().getProtection().getLocked();\n      console.log(`Cell ${cellRange.getAddress()} protection status: ${cellProtectionStatus}`);\n      if (cell !== \"\") {\n        if (!cellProtectionStatus) {\n          lockCells.push(cellRange);\n          console.log(\"PUSH lock cell\");\n        }\n      } else {\n        if (cellProtectionStatus) {\n          unlockCells.push(cellRange);\n          console.log(\"PUSH unlock cell\");\n        }\n      }\n    });\n  });\n\n  // Apply the changes in batches if arrays are not empty\n  if (lockCells.length > 0) {\n    console.log(\"Locking cells\");\n    lockCells.forEach(cellRange => cellRange.getFormat().getProtection().setLocked(true));\n  }\n  if (unlockCells.length > 0) {\n    console.log(\"Unlocking cells\");\n    unlockCells.forEach(cellRange => cellRange.getFormat().getProtection().setLocked(false));\n  }\n\n  // Protect the sheet with the password\n  sheet.getProtection().protect({}, password);\n}","description":"","noCodeMetadata":"","parameterInfo":"{\"version\":1,\"originalParameterOrder\":[],\"parameterSchema\":{\"type\":\"object\",\"default\":{},\"x-ms-visibility\":\"internal\"},\"returnSchema\":{\"type\":\"object\",\"properties\":{}},\"signature\":{\"comment\":\"\",\"parameters\":[{\"name\":\"workbook\",\"comment\":\"\"}]}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}